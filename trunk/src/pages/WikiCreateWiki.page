<apex:page id="WikiCreateWiki" controller="WikiCreateWikiController" tabStyle="WikiPage__c" sidebar="false" >
	<!-- Scripts --> 
	<apex:includeScript value="{!URLFOR($Resource.WikiResource, 'inc/js/common.js')}"/>
	<apex:includeScript value="{!URLFOR($Resource.Script_aculo_us, 'prototype.js')}"/>
	<apex:includeScript value="{!URLFOR($Resource.Script_aculo_us, 'scriptaculous.js')}"/>
	<apex:includeScript value="{!URLFOR($Resource.Script_aculo_us, 'effects.js')}"/>
	<script src="{!URLFOR($Resource.TeamsResources, 'inc/js/autocomplete.js')}" />
	
	<!-- Portal Support -->
	<apex:includeScript value="{!$Resource.portalSupport}"/>
	<apex:includeScript value="{!URLFOR($Resource.OverlayFunctionsFixed, 'js/overlayFunction.js')}"/>
	<apex:includeScript value="{!URLFOR($Resource.WikiResource, 'inc/js/WikiOverview.js')}"/>
	
    <!-- CSS styles for Portal Integration -->  
    <apex:stylesheet value="{!URLFOR($Resource.portalStyles, 'portal.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/headerTeams.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/widgetTeam.css')}" />
    <apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/teamsCreateNewTeam.css')}" />
    
	<!-- Styles -->
	<apex:stylesheet value="{!URLFOR($Resource.WikiResource, 'inc/css/commonLayout.css')}" />
	<apex:stylesheet value="{!URLFOR($Resource.WikiResource, 'inc/css/WikiOverview.css')}" /> 
	<apex:stylesheet value="{!URLFOR($Resource.commonResources, 'inc/css/myTeamsAllTeamsTabs.css')}" />
	<apex:stylesheet value="{!URLFOR($Resource.commonResources, 'inc/css/fonts.css')}" />
	
	
	<!-- CSS de TS -->
	<link rel="stylesheet"  href="{!URLFOR($Resource.commonResources, '/inc/css/validator.css')}" />	
	<link rel="stylesheet"  href="{!URLFOR($Resource.TeamsResources, '/inc/css/commonLayout.css')}" />	
	<link rel="stylesheet"  href="{!URLFOR($Resource.TeamsResources, '/inc/css/teamDetailEdit.css')}" />	
	<link rel="stylesheet"  href="{!URLFOR($Resource.TeamsResources, '/inc/css/teamDetail.css')}" />	
	<link rel="stylesheet"  href="{!URLFOR($Resource.TeamsResources, '/inc/css/teamCreateNew.css')}" />
	
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/teamOverview.css')}" />	
	
	<!-- Common Js for All Sections -->
	<apex:includeScript value="{!URLFOR($Resource.commonResources, 'inc/js/validator.js')}"/>
    
    
    <apex:stylesheet value="{!URLFOR($Resource.WikiResource, 'inc/css/wikiCreateWiki.css')}" />
    
    
    <!-- ****************************************************************************** -->
    
    	<!-- Scripts --> 
	
	<apex:includeScript value="/soap/ajax/12.0/connection.js" />
	<script>
		var API_SESSION_ID = '{!$Api.Session_ID}'; 
	</script>

	<script src="{!URLFOR($Resource.TeamsResources, 'inc/js/teamsCreateNewTeam.js')}" />

	<!-- Common Js for All Sections -->
	<script src="{!URLFOR($Resource.commonResources, 'inc/js/common.js')}" />
	<script src="{!URLFOR($Resource.TeamsResources, 'inc/js/TeamMemberList.js')}" />

	<!-- Common css for modal -->
	<link rel="stylesheet" media="screen" href="{!URLFOR($Resource.commonResources, 'inc/css/modal.css')}" />

	<!-- CSS de TS -->
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, '/inc/css/teamOverlyManage.css')}" />
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, '/inc/css/teamMemberList.css')}" />
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, '/inc/css/teamOverlyInviteNewMember.css')}" />

	<!-- CSS styles for Portal Integration -->
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/teamsOverlaysTemplate.css')}" />
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/widgets/TeamMemberWidget.css')}" />

	<script>
     	/**
        * Namespace Prefix Getter
        */
     	var globalTeamId = "{!WikiId}";
     	var globalArrowDown = "{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}";
     	var globalArrowUp = "{!URLFOR($Resource.commonResources, 'images/arrows/arrow_up.gif')}";;
     </script>

	<!-- Modal JS -->
	<script	src="{!URLFOR($Resource.commonResources, 'inc/js/modal.js')}" />
	
	<!-- Initialize the overlay box for modal.js -->
	<a href="#modal_container" id="initializeModalOverlay" style="display:none;"></a>
	<div id="modal_container" style="display:none;"></div>
	<script>
		createOverlay('initializeModalOverlay');
	</script>	
	
	<apex:form >
		<apex:actionFunction name="reloadMemberList" action="{!refresh}"
			rerender="membersList" />
	</apex:form>

	<!-- TeamsMemebersList CSS 	-->
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/teamsMembersList.css')}" />

	<!-- TeamsMemebersList JS  -->
	<script src="{!URLFOR($Resource.TeamsResources, 'inc/js/teamsMembersList.js')}" />

    <!-- ****************************************************************************** -->
    
	<style>
		.noWikisYet {
			text-align: center;
			margin: 40px;
		} 
		
		.teamTitle{
			color: #526921;
		}
		
		div.main_content{
			margin: 15px;
		}
		
		.body_center{
			height: 700px !important;
			background:#FFFFFF none repeat scroll 0 0;
			border:1px solid #B5B5B5;	
		
		}

		div.tabContainer {
			background-color:transparent;
			margin-left: 20px;
			margin-right: 20px;
			height:16px;
			overflow:visible;
		}	
		div.tabBorder {
			margin-left: 0px;
			
		}
		
		ul.tabs li{
			height: 20px;
			margin-top: 7px;
		}
		
		a.disable{
			color:#C9C9C9 !important;
			cursor:auto;
		}
		
		div.holder{
			margin:16px 1px 1px !important;
			_margin-top: 0 !important;
		}
		
		body#bodyWiki table.bodyTable td.sideBarTD {
			width:194px;
		}
		
		.SaveBtn{
			background:#526921 none repeat scroll 0 50%;
			width:auto !important;
		}
		
		.title_line_btn {
			border-bottom:1px solid #999999;
			margin-left: 70px !important;
		}
		
		div.main_content div.holder div.message_to_user {
			margin:10px 31px 0;
		}
		
	</style>
	<script>
		var inEdition = {!inEdition};
		var wikiType = "{!Wiki.Type__c}";
	
		if(inEdition == false){
			var globalSaveButton = 'Create';
			var globalMembersButton = 'Create And Add Members';
		}else{
			var globalSaveButton = 'Update';
		}

		
		document.observe('dom:loaded',startupFunc);
		
		function startupFunc(){

			if((wikiType != null) && (wikiType != '') && (inEdition == true)){
				if(wikiType == 'open'){
					$('openTeam').checked= true;
				}
				else if(wikiType == 'close'){
					$('closedTeam').checked= true;
				}
				else if(wikiType == 'private'){
					$('privateTeam').checked= true;
				}		
			}else{
				$('WikiCreateWiki:createNewTeamForm:openOrClosed').value = 'open';
			}

			var version;
			if (navigator.appName == "Microsoft Internet Explorer") {
				version = navigator.appVersion;
				if (version.indexOf("MSIE 6") != -1) {
					document.getElementById('loader__').className = 'loaderIE6__';
					document.getElementById('loader__').style.position = 'absolute';
				}
			}
		}
			
		function fixHeader () {
			var inputWidth = 390 - $('labelDisc').getWidth();
			var inputDisc = $('inputDisc');
			inputDisc.style.width = inputWidth -2 + 'px';
		}
			
		/**
		* Validate form
		*@void
		*/
		function validateWikiFormInfo(){
			$('WikiCreateWiki:createNewTeamForm:saveButton').value = 'Saving';
			$('WikiCreateWiki:createNewTeamForm:cancelButton').value = 'Saving';
			if(inEdition == false){
				$('WikiCreateWiki:createNewTeamForm:saveAndAddMembersButton').value = 'Saving';
			}	
				
			$('currentEventAction').innerHTML = 'Validate form information...';
			var inputAction = $('WikiCreateWiki:createNewTeamForm:saveButton');
			var name = $('WikiCreateWiki:createNewTeamForm:TeamName');
			var error = false;
			//Name Validate
			if(name.value == ''){
				name.style.border = 'solid #C0272D 2px';
				Effect.Appear('TeamNameErrorMessage');
				error = true;
			}else{
				name.style.border = '';
				Effect.Fade('TeamNameErrorMessage');
			}
		
			//Image right validate
			if($$('#imageTeamContainer input')[0].value != '' && $('imageRights').checked == false){
				$('imageRightsHolder').style.background = '#C0272D';
				Effect.Appear('RightsErrorMessage');
				error = true;
			}else{
				$('imageRightsHolder').style.background = '';
				Effect.Fade('RightsErrorMessage');
			}
			
			//Check error
			if(error){
				
				$('.body_center');
				$('WikiCreateWiki:createNewTeamForm:saveButton').value = globalSaveButton;
				$('WikiCreateWiki:createNewTeamForm:cancelButton').value = 'Cancel';
				if(inEdition == false){
					$('WikiCreateWiki:createNewTeamForm:saveAndAddMembersButton').value = globalMembersButton;
				}
				showError('');
			}else{
				Effect.Fade('warning_to_user');
				$('currentEventAction').innerHTML = 'Saving Wiki Information...';
			} 
			$('currentEventAction').innerHTML = '';
			return error;		
		}
			
		/**
		* Enabled & Disable selects for selected team access
		*@param Object radio
		*/
		function setAccess(radio){
			if(radio.checked == true && radio.id == 'openTeam'){
				$('WikiCreateWiki:createNewTeamForm:openOrClosed').value = 'open';
			}else if (radio.checked == true && radio.id == 'closedTeam'){
				$('WikiCreateWiki:createNewTeamForm:openOrClosed').value = 'close';
			}else if (radio.checked == true && radio.id == 'privateTeam'){
				$('WikiCreateWiki:createNewTeamForm:openOrClosed').value = 'private';
			}
		}
		
		/**
		* Count character length
		*@param Obeject area
		*@param String Id indicator
		*/
		function countStringLimit(area, indicator){
			$(indicator).innerHTML = (32700 - area.value.length);
		}
		
		/**
		* Show error div & inject custom message
		*@param String message
		*/
		function showError(message){
			//$('messageErrorText').innerHTML = '*' + message;
			Effect.Appear('warning_to_user');
			Effect.ScrollTo('anchorForError');
		}
	</script>		

	<!-- Scripts to show the new members overlay and the members list -->
		<script>
			var settingsBackUp = '';
			var membersBackUp = '';
			var isAdd = getURLParam('add');
			var insideSettingsTab = true;
			
			function showSettingsSection(){
				membersBackUp = $('body_center').innerHTML;
				$('body_center').innerHTML = settingsBackUp;
				console.info('Inside: * showSettingsSection *');
			}
			
			function showMembersSectionTabs(){
					settingsBackUp = $('body_center').innerHTML;
					$('body_center').innerHTML = membersBackUp;					
			}
			
		
			function showMembersSectionMetod(){
				$('WikiCreateWiki:tabsForm:allTeamsLink').className= ''; //take off the disable style
				
				$('body_center').innerHTML = membersBackUp;
				
				$('myTeamTab').className = '';
				$('allTeamTab').className = 'selected';
				insideSettingsTab = false;
			}
			
			function backUpDivsForFirstTime(){
				settingsBackUp = $('body_center').innerHTML;
				membersBackUp = $('membersListDiv').innerHTML;
			}
			
			
			/**
			* Execute onload to show members tab and open add members overlay
			*/
			function showAddMembersSection(){
				backUpDivsForFirstTime();
				if(isAdd != ''){
					showMembersSectionMetod();
					createOverlay('','inviteTeam','auto','showSelects()');
				}
			}
			
			function switchTabs (element){
				var currentTab = $(element);
				if(currentTab.className != 'selected' && currentTab.id == 'myTeamTab' && insideSettingsTab == false){
					$('allTeamTab').className = '';
					currentTab.className = 'selected';
					insideSettingsTab = true;
					showSettingsSection();
				}else if (currentTab.className != 'selected' && currentTab.id == 'allTeamTab' && insideSettingsTab == true){
					$('myTeamTab').className = '';
					currentTab.className = 'selected';
					insideSettingsTab = false;
					showMembersSectionTabs();
				}
				
			}
			
		</script>
	<!-- End of scripts to show the new members overlay and the members list -->

	<div class="BodyPage">

		<!-- OVERLAY -->
		<div class="UPF__overlay__" id="UPF__overlay__" style="display:none;"></div>
		
		<!-- LOADER	-->
		<div class="loader__" id="loader__" style="display:none;"><center><img src="{!URLFOR($Resource.commonResources, 'images/loaders/bigLoader.gif')}" /></center><br />Loading...</div>
		
		<!-- HEADER -->
		<apex:composition template="HeaderTemplate">
			<apex:define name="moduleId"><apex:variable var="moduleId" value="headerWiki"/></apex:define>
		    <apex:define name="module">Wiki pages</apex:define>
		    <apex:define name="title">OverView</apex:define>
		    <apex:define name="search">
		    	<c:Search module="wiki" />
		    </apex:define>
	    </apex:composition>
	    
	    <!-- MAIN PAGE -->
	    <div class="MainPage">
			<div class="PageBlock">	
				<!-- LEFT SIDEBAR  -->
				<table border="0" class="bodyTable">
					<tr>
						<td valign="top" class="sideBarTD">
							<!-- MY FAVORITES WIDGET -->
							<c:WikiWidgetMyFavorites />
							
							
							<!-- MY RECENT CHANGES WIDGET -->
							<c:WikiWidgetMyRecentChanges />
							
							 
						</td>
						<td valign="top" class="mainContentTD">
				
							<!--  MAIN CONTENT DIV  - -->
							<div class="main_content" id="main_content">
								<div class="teamTitle">{!IF(inEdition == false, 'Create New', 'Edit')} {!$ObjectType.Wiki__c.label}</div>
							
							<!-- TAB CONTAINER
							<div class='tabContainer' >
								<ul class="tabs">
									<li  class="selected" id="myTeamTab">
										<span id="My_teams" class="tabLinks" onclick="showSettingsSection();">Settings</span>
									</li>
									<li id="allTeamTab">
										<span id="OutputLinkMembers" class="{!IF((hasMembers == false),'disable','')}" onclick="showMembersSectionTabs();">Members</span>
									</li>					 
								</ul>	
							</div> -->
							
							
								<div class="tabContainer">
									<apex:form id="tabsForm">
										<ul class="tabs">
											<li class="selected" id="myTeamTab">
												<apex:commandLink id="My_teams" action="{!switchTabsController}" value="Settings" 
																	onclick="switchTabs('myTeamTab');" 
																	rerender="holder">
													<apex:param name="allTeams" value="false" />
												</apex:commandLink>
											</li>
											<li id="allTeamTab" >
												<apex:commandLink id="allTeamsLink" action="{!switchTabsController}" value="Members" onclick="switchTabs('allTeamTab');"
																	 rerender="holder" styleClass="{!IF((hasMembers == false),'disable','')}">
													<apex:param name="allTeams" value="true" />
												</apex:commandLink>
											</li>					
										</ul>
									</apex:form>
								</div>
							
							<!-- HOLDER -->
							<div class="holder">				
								<div id="body_center" class="body_center">
									<a id="anchorForError"></a>
										<div id="warning_to_user" class="message_to_user" style="display:none;" >
				    						<div class="f_left">
				      							<img src="{!URLFOR($Resource.TeamsResources, 'images/layout/icons/error_icon.gif')}" />
				    						</div>
				    						<div class="f_left">
												<strong>We had trouble unserstanding one or more of your entries or we need more information</strong><br />
					 							<span id="messageErrorText">Please see the field(s) highlighted</span>
											</div>
					  						<div class="clear"></div>
				  						</div>		
										<div align="right">	
											<table border="0" style="margin: 5px 0px 5px 0px;">
												<tr>
													<td style="width: 4px;">
														<span class="requiredLegend"></span>
													</td>
													<td>		
														<span class="infoText" style="font-size: 9px; font-family: Arial, Helvetica, sans-serif;">
															=&nbsp;Required Information 
														</span>
													</td>
												</tr>
											</table>
										</div> 
										<apex:form id="createNewTeamForm" onsubmit="if(validateWikiFormInfo())return false;" >
										<!-- <apex:form id="createNewTeamForm" > --> 
											<apex:outputpanel style="display:none;" id="currentTeamId">{!Wiki.Id}</apex:outputpanel>
											<apex:inputHidden value="{!Wiki.PictureId__c}" id="teamPicture" />
											<div class="div_Body">
												<table cellpadding="0" cellspacing="0" style="margin-left: 40px;" class="newTeamForm">
													<tr>
														<td class="alignTop">
															<span class="inputInfoTitle">{!$ObjectType.Wiki__c.label} Name</span>
														</td>
														<td style="width: 4px; vertical-align:top;">
															<span class="requiredLegend"></span>
														</td>
														<td colspan="2">&nbsp;
															<apex:inputText value="{!Wiki.Name}" id="TeamName" styleClass="RQ_String" ></apex:inputText>
															<br />
															<span id="TeamNameErrorMessage" class="errorText" style="display:none;">
																<b>Error:</b> You must enter a name for this {!$ObjectType.Wiki__c.label}
															</span>
														</td>
													</tr>
													<tr>
														<td height="7px"></td>
													</tr>
													<tr>
														<td class="alignTop">
															<span class="inputInfoTitle">Description</span>
														</td>
														<td></td>
														<td colspan="2">&nbsp;
															<apex:inputTextarea value="{!Wiki.Description__c}" id="TeamDescription" cols="38" rows="4" style="height: 83px; width: 430px" onkeyup="countStringLimit(this, 'stringSizeCounter');" />
														</td>
													</tr>
													<tr>
														<td></td>
														<td></td>
														<td colspan="2">&nbsp;
															<span class="explain">(32k character limit) - Characters remaining:</span>
															<span class="explain" id="stringSizeCounter">32700</span>
															<br />
														</td>
													</tr>
													<tr>
														<td height="10px"></td>
													</tr>
													<tr>
														<td class="alignTop">
															<!--  <span class="inputInfoTitle">{!$ObjectType.Wiki__c.label} Email</span> -->
														</td>
														<td style="width: 4px; vertical-align:top;">
														</td>
														<td colspan="2">&nbsp;
															<!-- <apex:inputText value="{!Wiki.ContactEmail__c}" id="TeamContactEmail"></apex:inputText> -->
														</td>
													</tr>
													<tr>
														<td height="10px"></td>
													</tr>
													<tr>
														<td class="alignTop">
															<span class="inputInfoTitle">{!$ObjectType.Wiki__c.label} Avatar</span>
														</td>
														<td></td>
														<td>&nbsp;
															<img width="99" src="{!IF(wikiPicture == '', URLFOR($Resource.TeamsResources, '/images/layout/pic_upload.gif'), wikiPicture)}" class="imgBorder" />
															<br />
															<span class="explain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current picture</span>
														</td>
														<td valign="top">
															<table cellpadding="0" cellspacing="0" width="400px">
																<tr>
																	<td>
																		<span class="inputInfoDescription">Select the image file</span>
																	</td>
																</tr>
																<tr>
																	<td>
																		<span class="inputInfoSubDescription" style="padding-left: 10px;">Type the path of the file or
																		click the Browse button to find the file.</span>
																	</td>
																</tr>
																<tr>
																	<td></td> 
																</tr>
																<tr>
																	<td class="paddingLeft" id="imageTeamContainer" >
																		<apex:inputFile value="{!document.body}" id="teamImage" filename="{!document.name}" contentType="{!document.contentType}" fileSize="{!document.BodyLength}"/> 
																		<br />
																		<span id="fileExtensionError" class="errorText" style="display:none;">
																			<b>Error:</b> You must enter a jpg, gif or png files only
																		</span>
																		<apex:outputpanel rendered="{!NOT validSizePicture}">
																		<span id="fileSizeError" class="errorText">
																			<b>Error:</b> The images size must be less than 512 kb
																		</span>
																		</apex:outputpanel>
																	<td>
																</tr>
																<tr>
																	<td></td>
																</tr>
																<tr>
																	<td class="paddingLeft"><span class="explain">File size	limit 512KB. If your upload does not work, try a smaller picture. </span>
																	</td>
																</tr>
																<tr>
																	<td class="paddingLeft">
																		<span class="explain">Ideal	size is 100 pixels high by 100 pixels wide.</span>
																	</td>
																</tr>
																<tr>
																	<td></td>
																</tr>
																<tr>
																	<td class="paddingLeft">
																		<div class="imageRightsHolder" id="imageRightsHolder">
																			<input id="imageRights" type="checkbox" />
																		</div>
																		<div class="messageRigthHolder">
																			<span class="inputInfoSubDescription">I certify that I have the right to distribute this picture and that it does not violate the <a href="/apex/TeamsIconTerms" target="_blank">Terms of Use</a></span>
																			<br />
																			<span id="RightsErrorMessage" class="errorText" style="display:none;">
																				<b>Error:</b> You must agree to the <a href="/apex/TeamsIconTerms" target="_blank">Terms of Use</a> to use images for this team.															
																			</span>
																		</div>
																		<div class="clear"></div>													
																	</td>
																</tr>
																<tr>
																	<td></td>
																</tr>	
															</table>
														</td>
													</tr>
													<tr>
														<td height="10px"></td>
													</tr>
													<tr>
														<td class="alignTop">
															<!-- <span class="inputInfoTitle">
																{!$ObjectType.Wiki__c.label} Type
															</span>
															-->
														</td>
														<td style="width: 4px; vertical-align:top;">
															<!-- <span class="requiredLegend"></span> -->
														</td>
														<td colspan="2">&nbsp;	
															<!-- <apex:selectList id="TeamType" value="{!Wiki.Type__c}" title="" multiselect="false" size="1" >
													  	 	 	<apex:selectOptions value="{!Types}"/>
													  	 	</apex:selectList>
													  	 	<span id="TeamTypeErrorMessage" class="errorText" style="display:none;">
																<b>Error:</b> You must enter a {!$ObjectType.Wiki__c.label} Type for this {!$ObjectType.Wiki__c.label}.								  	 	
													  	 	</span> -->	
														</td>
													</tr>
													<tr>
														<td>&nbsp;</td>
													</tr>
													<tr>
														<td class="alignTop">
															<!-- <span class="inputInfoTitle">{!$ObjectType.Wiki__c.label} Parent</span> -->
														</td>
														<td></td>
														<td colspan="2">&nbsp;
															
														</td>
													</tr>
													<tr>
														<td>&nbsp;</td>
													</tr>
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle">Access</span></td>
														<td></td>
						                                <td colspan="2">
						                                	&nbsp;<input type="radio" id="openTeam" checked="checked" name="access" onclick="setAccess(this);"/>
						                                	<span class="inputInfoDescription">Open</span>
						                                </td>
													</tr>  	
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">&nbsp;<span class="inputInfoList">&nbsp;</span><span class="inputInfoSubDescription">Anyone can join. Anyone can see the {!$ObjectType.Wiki__c.label} information and content.</span></td>
													</tr>	
													<tr>
														<td colspan="6" >
													
														</td>
													</tr>					
													<tr>
						                                <td  class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">
						                                	&nbsp;<input type="radio" id="closedTeam" name="access" onclick="setAccess(this);"/>
						                                	<span class="inputInfoDescription">Closed</span>
						                                </td>
													</tr>   
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">
						                                	<span class="inputInfoList">&nbsp;</span>
						                                	<span class="inputInfoSubDescription">{!$ObjectType.Wiki__c.label} Administrator must invite users to join. Anyone can see the {!$ObjectType.Wiki__c.label} information and content.</span>
						                                </td>
													</tr> 
													<tr>
														<td colspan="6">
														
														</td>
													</tr>	
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">
						                                	&nbsp;<input type="radio" id="privateTeam" name="access" onclick="setAccess(this);"/>
						                                	<span class="inputInfoDescription">Private</span>
						                                </td>
													</tr>   
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">
						                                	&nbsp;<span class="inputInfoList">
						                                	&nbsp;</span>
						                                	<span class="inputInfoSubDescription">This {!$ObjectType.Wiki__c.label} will not appear in search results or in the profiles of its members. </span>
						                                </td>
													</tr> 
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">&nbsp;<span class="inputInfoList">&nbsp;</span><span class="inputInfoSubDescription">Membership is by invitation only, and only members can see the {!$ObjectType.Wiki__c.label}</span></td>
													</tr>   
													<tr>
						                                <td class="alignTop"><span class="inputInfoTitle"></span></td>
														<td></td>
						                                <td colspan="2">&nbsp;<span class="inputInfoList">&nbsp;</span><span class="inputInfoSubDescription">information and content.</span></td>
													</tr>   
												</table>
												<div class="DivBtn">
													<div class="title_line_btn"></div>										
													<div align="center">
														<span id="currentEventAction"></span><br />
														<apex:commandButton styleClass="SaveBtn" action="{!saveWiki}"  value="{!IF(inEdition == false, 'Create', 'Update')}" id="saveButton"  />
														<apex:outputpanel rendered="{!NOT inEdition}">
															<apex:commandButton styleClass="SaveBtn" action="{!saveWikiAndAddMembers}"  value="Create And Add Members" id="saveAndAddMembersButton" />
														</apex:Outputpanel>
														<apex:inputHidden value="{!Wiki.Type__c}" id="openOrClosed" />
														<apex:commandButton styleClass="cancelBtn" onclick="history.go(-1);" value="Cancel" id="cancelButton"/> 
													</div>
												</div>
											</div>
										</apex:form>
									</div>
								</div>
							</div>
						</div>
						</td>
					</tr>
					<!--<tr>
						 <td colspan="2">
							<div class="SidebarTitle" />
						</td> 
					</tr>-->
				</table>
			</div>
		</div>
	</div>
	<apex:outputpanel id="auxPanel" style="display:none;">
	</apex:outputpanel>	
	<script>
		readPortalCSSRules();
	</script>	
	
	<!-- MEMBERS LIST --> 
    	<div id="membersListDiv" class="holder" style="visibility: hidden;">
	<div id="paginationOverlay" style="display: none;">
	<div class="loader"><img
		src="{!URLFOR($Resource.discussionResourceFiles, 'images/common/layout/big-loader.gif')}"
		alt="Loading..." title="Loading..." /></div>
	</div>
	<table width="100%" align='center'>
		<tr>
			<td class="teamTitleButton titleTd">Members</td>
			<td align='center'>
			<table width="270">
				<tr>
					<td>
					<div><!-- BUTTONS --> <apex:outputpanel rendered="true" > 
						<a onclick="createOverlay('','inviteTeam','auto','showSelects()');"
							href="javascript:;" class="blackbutton">New</a>
						<a href="javascript:;" class="blackbutton"
							onclick="massiveRemoveOverlay();">Remove</a>
						<!-- <div class="editProfile"><a href="javascript:;"
							class="blackbutton" onclick="showHideOptions();">Edit
						{!$ObjectType.Wiki__c.label} Profile | v</a>
						<div id="profileOptions" class="profileOptions"
							style="display: none;">
						<ul>
							<apex:repeat value="{!WikiEditProfiles}" var="item">
								<li onclick="massiveMemberUpdate(this);"
									onmouseover="bckColor(this)" onmouseout="bckColor(this)"
									id="{!item.Id}">{!item.Name}</li>
							</apex:repeat>
						</ul>
						</div>
						</div> -->
					</apex:outputpanel> <!-- BUTTONS --></div>
					</td>
				</tr>
			</table>
			</td>
			<td class="teamTitleButton titleTd">
			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
		</tr>
	</table>
	<div class="border_body_top"></div>
	<!-- - - - - - - - - - - - - - - - - - - - - -->
	<!-- 			LETTER FILTER			     -->
	<br>

	<div style="position: relative; overflow: hidden"><img
		id="twistImage" style="vertical-align: middle;" class="twistImg"
		onclick="showHideElement(document.getElementById('filterDiv'),this);"
		src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}"
		title="Hide Section" alt="Hide Section" /> &nbsp; <a
		href="javascript:;"
		onclick="showHideElement(document.getElementById('filterDiv'),document.getElementById('twistImage'));"
		class="filterLink">Filter</a></div>
	<div class="filter" id="filterDiv">
	<div align="center"><apex:form id="filterForm">
		<ul class="letterFilter">
			<li><apex:commandLink action="{!genMembers}" value="ALL"
				styleclass="AllBtn" rerender="membersList">
				<apex:param name="ltr" value="ALL" />
			</apex:commandLink></li>
			<apex:repeat id="letterFilterRepeat" value="{!letterFilter}"
				var="item">
				<li><apex:outputpanel rendered="{!NOT(item.containMembers)}">
					<apex:commandLink styleclass="contains" action="{!genMembers}" 
						value="{!item.letter}" rerender="membersList">
						<apex:param name="ltr" value="{!item.letter}" />
					</apex:commandLink>
				</apex:outputpanel> <apex:outputpanel rendered="{!(item.containMembers)}">
													{!item.letter}
												</apex:outputpanel></li>
			</apex:repeat>
		</ul>
		<br style="clear: both; font-size: 3px;" />
	</apex:form></div>
	</div>
	<apex:outputpanel rendered="{!IF(AND(prevPageShow,nextPageShow),false,true)}">
		<hr class="filterHR">
	</apex:outputpanel> <apex:outputpanel id="membersList">
		<apex:outputpanel styleClass="pagination" layout="block"
			rendered="{!IF(AND(prevPageShow,nextPageShow),false,true)}">
			<div class="pages"><apex:form >
				<ul>
					<li class="prev {!IF(prevPageShow,'prev_disabled','')}"><apex:commandLink action="{!prevPage}" value="Previous Page" rerender="membersList"
						rendered="{!prevPageLinkShow}" /> <apex:outputText value="Previous Page" rendered="{!prevPageShow}" /></li>
					<li>({!currentPagination} - {!cntPagination})</li>
					<li class="next {!IF(nextPageShow,'next_disabled','')}"><apex:commandLink action="{!nextPage}" value="Next Page" rerender="membersList"
						rendered="{!nextPageLinkShow}" /> <apex:outputText value="Next Page" rendered="{!nextPageShow}" /></li>
				</ul>
			</apex:form></div>
		</apex:outputpanel>
		<apex:form >
			<table border="0" cellspacing="0" cellpadding="2px" class="pageList">
				<thead>
					<tr>
						<td width="3%"><apex:outputpanel > <!-- rendered="{!userPermissions.canManage}" -->
							<input class="actionCheckAll" onclick="checkUnCheck(this);"
								type="checkbox" />
						</apex:outputpanel></td>
						<td width="9%"><apex:outputpanel style="font-weight:bold;">Action</apex:outputpanel> <!-- rendered="{!userPermissions.canManage}" --> 
						</td>
						<td width="29%" colspan="2"><apex:commandLink styleclass="member_title_description" action="{!sortList}"
							value="Full Name" rerender="membersList">
							<apex:param name="sb" value="User__r.Name" />
						</apex:commandLink>&nbsp; <apex:outputpanel rendered="{!IF(sortBy == 'name',true,false)}">
							<apex:outputpanel rendered="{!sortByDesc}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}" />
							</apex:outputpanel>
							<apex:outputpanel rendered="{!NOT(sortByDesc)}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_top.gif')}" />
							</apex:outputpanel>
						</apex:outputpanel></td>
						<td width="16%"><apex:commandLink styleclass="member_title_description" action="{!sortList}"
							value="Company" rerender="membersList">
							<apex:param name="sb" value="User__r.CompanyName" />
						</apex:commandLink>&nbsp; <apex:outputpanel rendered="{!IF(sortBy == 'company',true,false)}">
							<apex:outputpanel rendered="{!sortByDesc}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}" />
							</apex:outputpanel>
							<apex:outputpanel rendered="{!NOT(sortByDesc)}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_top.gif')}" />
							</apex:outputpanel>
						</apex:outputpanel></td>
						<td width="15%"><apex:commandLink styleclass="member_title_description" action="{!sortList}"
							value="Title" rerender="membersList">
							<apex:param name="sb" value="User__r.Title" />
						</apex:commandLink>&nbsp; <apex:outputpanel rendered="{!IF(sortBy == 'title',true,false)}">
							<apex:outputpanel rendered="{!sortByDesc}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}" />
							</apex:outputpanel>
							<apex:outputpanel rendered="{!NOT(sortByDesc)}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_top.gif')}" />
							</apex:outputpanel>
						</apex:outputpanel></td>
						<td width="16%"><apex:commandLink styleclass="member_title_description" action="{!sortList}"
							value="{!$ObjectType.Wiki__c.label} Profile"
							rerender="membersList">
							<apex:param name="sb" value="TeamProfile__r.Name" />
						</apex:commandLink>&nbsp; <apex:outputpanel rendered="{!IF(sortBy == 'profile',true,false)}">
							<apex:outputpanel rendered="{!sortByDesc}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}" />
							</apex:outputpanel>
							<apex:outputpanel rendered="{!NOT(sortByDesc)}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_top.gif')}" />
							</apex:outputpanel>
						</apex:outputpanel></td>
						<!-- <td width="12%px"><apex:commandLink styleclass="member_title_description" action="{!sortList}"
							value="{!$ObjectType.Wiki__c.label} Role" rerender="membersList">
							<apex:param name="sb" value="WikiRole__c" />
						</apex:commandLink>&nbsp; <apex:outputpanel rendered="{!IF(sortBy == 'role',true,false)}">
							<apex:outputpanel rendered="{!sortByDesc}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_down.gif')}" />
							</apex:outputpanel>
							<apex:outputpanel rendered="{!NOT(sortByDesc)}">
								<img
									src="{!URLFOR($Resource.commonResources, 'images/arrows/arrow_top.gif')}" />
							</apex:outputpanel>
						</apex:outputpanel></td> -->
					</tr>
				</thead>
				<!-- Description  -->
				<tbody>
					<apex:repeat var="item" value="{!members}"
						rows="{!numberOfItemsToShow}" first="{!firstRow}">
						<tr>
							<td><apex:outputpanel >  <!-- rendered="{!userPermissions.canManage}" -->
								<input value="{!item.wikiMemberId}" class="actionCheck"
									type="checkbox" />
							</apex:outputpanel></td>
							<td> <!-- <apex:outputpanel rendered="{!userPermissions.canManage}">
								<apex:commandLink styleclass="member_detail_description_underline" value="Edit"
									action="{!assignEditId}" rerender="overlaysPanel"
									onclick="createOverlay('','editMemberInfoLoading','270','');"
									oncomplete="createOverlay('','editMemberInfo','270','showSelects()');">
									<apex:param name="editId" value="{!item.userId}" />
								</apex:commandLink>
								<!-- <a href="javascript:;" class="member_detail_description_underline">Edit</a>&nbsp;| 
							</apex:outputpanel> <apex:outputpanel rendered="{!userPermissions.canManage}">|</apex:outputpanel> -->
							<apex:outputpanel > <!-- rendered="{!userPermissions.canManage}" --> 
								<apex:commandLink styleclass="member_detail_description_underline" value="Del"
									action="{!assignRemoveId}" rerender="overlaysPanel"
									oncomplete="createOverlay('','removeMemberOverlay','155','');">
									<apex:param name="delId" value="{!item.userId}" />
								</apex:commandLink>
								<!-- <a href="javascript:;" class="member_detail_description_underline">Delete</a> -->
							</apex:outputpanel></td>
							<td class="member_detail_description"><a href="javascript:;"
								onclick="location.href='https://na1.salesforce.com/apex/PeopleProfileDisplay?id={!item.userId}'"
								class="member_detail_description_underline">{!item.Name}</a>
							</td>
							<td class="member_detail_description">{!item.company}</td>
							<td class="member_detail_description">{!item.title}</td>
							<td class="member_detail_description">{!item.profile}</td>
							<td class="member_detail_description">{!item.role}</td>
						</tr>
					</apex:repeat>
				</tbody>
			</table>
		</apex:form>
		<hr class="filterHR">
		<apex:outputpanel styleClass="pagination" layout="block"
			rendered="{!IF(AND(prevPageShow,nextPageShow),false,true)}">
			<div class="pages"><apex:form >
				<ul>
					<li class="prev {!IF(prevPageShow,'prev_disabled','')}"><apex:commandLink action="{!prevPage}" value="Previous Page" rerender="membersList"
						rendered="{!prevPageLinkShow}" /> <apex:outputText value="Previous Page" rendered="{!prevPageShow}" /></li>
					<li>({!currentPagination} - {!cntPagination})</li>
					<li class="next {!IF(nextPageShow,'next_disabled','')}"><apex:commandLink action="{!nextPage}" value="Next Page" rerender="membersList"
						rendered="{!nextPageLinkShow}" /> <apex:outputText value="Next Page" rendered="{!nextPageShow}" /></li>
				</ul>
			</apex:form></div>
		</apex:outputpanel>
		<apex:outputpanel rendered="{!IF(AND(prevPageShow,nextPageShow),false,true)}">
			<hr class="filterHR">
		</apex:outputpanel>
		<table width="100%">
			<tr>
				<td class="teamTitleButton titleTd">
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
				<td align='center'>
				<table width="270">
					<tr>
						<td>
						<div><!-- BUTTONS --> <apex:outputpanel > <!-- rendered="{!userPermissions.canManage}" -->
							<a
								onclick="createOverlay('','inviteTeam','400','showSelects()');"
								href="javascript:;" class="blackbutton">New</a>
							<a href="javascript:;" class="blackbutton"
								onclick="massiveRemoveOverlay();">Remove</a>
							<!--  <div class="editProfile"><a href="javascript:;"
								class="blackbutton" onclick="showHideOptionsBottom();">Edit
							{!$ObjectType.Wiki__c.label} Profile | v</a>
							<div id="profileOptionsBottom" class="profileOptions"
								style="display: none;">
							<ul>
								<apex:repeat value="{!teamEditProfiles}" var="item">
									<li onclick="massiveMemberUpdate(this);"
										onmouseover="bckColor(this)" onmouseout="bckColor(this)"
										id="{!item.Id}">{!item.Name}</li>
								</apex:repeat>
							</ul>
							</div>
							</div> -->
						</apex:outputpanel> <!-- BUTTONS --></div>
						</td>
					</tr>
				</table>
				</td>
				<td class="teamTitleButton titleTd">
				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
			</tr>
		</table>
		<br>
	</apex:outputpanel>
	</div>
    <!-- END OF MEMBERS LIST -->
    
    <!-- NEW MEMBER OVERLAY -->
    <div id="newMemberDiv" style="visibility: hidden;">
    	
			<apex:outputpanel rendered="{!If(WikiName != null, true, false)}"> <!-- rendered="{!IF(UserPermissions.canManage, true, false)}" -->
		<!-- Common CSS Styling  -->
		<link rel="stylesheet"
			href="{!URLFOR($Resource.PeopleResourceFiles, 'inc/css/autocomplete.css')}"
			type="text/css" media="screen" charset="utf-8" />
		<link rel="stylesheet"
			href="{!URLFOR($Resource.TeamsResources, 'inc/css/teamOverlyInviteNewMember.css')}"
			type="text/css" /> 


		<!-- Content  -->
		<div id="inviteTeam" style="display: none;" class="overlayForm">
		<div class="swirly_overlay" style="display: none;"></div>
		<!-- Overlay Title -->
		<div class="overlayTitleContent">
		<div class="overlayTitle">Add new member to {!WikiName}</div>
		<div class="overlayCloseEvent"><a href="Javascript:;"
			onclick="modal.close();"> <img
			src="{!URLFOR($Resource.TeamsResources, 'images/layout/genericClose.gif')}"
			alt="Close Window" title="Close Window" /> </a></div>
		</div>
		<div class="overlayMainContent"><!-- Required Information --> <span
			class="overlayRequiredInfo">= Required Information</span> <apex:form id="newMemberForm"
			onSubmit="if(validateColleguesInput()){showSwirly('swirly_overlay');Form.disable(this.id);}else return false;">
			<div class="overlayFormContent">
			
			<table cellpadding="0" cellspacing="0"	style="margin: 0px; padding: 0px; width: 100%;">
				<tr>
					<td class="inputInfoTitle">
						<span class="inputInfoTitle">Add colleagues</span><br />
						<span class="explainBottom">(enter name or email)</span></td>
						
						<td style="width: 4px;">
							<span style="display: block; width: 4px; height: 67px; background-color: #C0272D;"></span>
						</td>
						
						<td>
							&nbsp; <apex:inputTextArea id="colleaguesNames"
							styleClass="colleaguesNames" style="width:310px; height:63px;"
							value="{!newMemberVars.colleagueNames}"
									onFocus="javascript:									
														var options = {
																script: function (input) {	
														 					return ('SuggestDispatcher?input='+input+'&class=colleagueNames&wikiId={!WikiId}');
														 				}									        		    
																}; 
														xml = new AutoComplete('{!$Component.colleaguesNames}',options);return true;"
							onBlur="javascript: hideSuggest();" /> <br/>
						</td>
				</tr>
				<tr>
					<td></td>
					<td></td>
					<td>
						&nbsp;<span class="explain">(comma separated)</span><br />
					</td>
				</tr>
			
				<tr>
					<td></td>
					<td></td>
					<td >
						<apex:inputCheckBox value="{!emailNotifications}" id="emailNotifications" />
						<span style="font-weight: bold; font-size: 13px; font-family: Arial, Helvetica, sans-serif; color: #666666;">Email notifications </span>
					</td>					
				</tr>
				
			
				<tr>
					<td></td>
					<td></td>
					<td >
						<apex:inputCheckBox value="{!makeMembersAdmins}" id="makeMembersAdmins"  />				
						<span style="font-weight: bold; font-size: 13px; font-family: Arial, Helvetica, sans-serif; color: #666666;">Make members administrators</span>					
					</td>					
				</tr>
			</table>
			
			</div>
			<div class="informationPanel clear" id="infoToUser"
				style="display: none;"></div>
			<div id="paginationOverlay" style="display: none;">
			<div class="loader"><img
				src="{!URLFOR($Resource.discussionResourceFiles, 'images/common/layout/big-loader.gif')}"
				alt="Loading..." title="Loading..." /></div>
			</div>
			<div class="overlaySeparateLine"></div>
			
			<!-- Save and Cancel Buttons -->
			<div class="overlayFromButtons" align="center">
				<apex:commandButton action="{!saveMembers}"
					oncomplete="statusSending(this);setTimeout('modal.close(); hideSwirly(\'swirly_overlay\')', 5000); showMessageToUser(); showSwirly('swirly_members');"
					styleclass="overlaySaveBtn" value="Send"
					rerender="membersListContainer" /> <apex:commandButton action="{!saveMembersNew}"
					oncomplete="statusSending(this);$('{!$Component.newMemberForm}').reset(); statusNormal(this);hideSwirly('swirly_overlay'); showSwirly('swirly_members');chargeMatrix(myMembersIds);"
					styleclass="overlaySaveBtn" value="Send & add more members"
					rerender="membersListContainer" />
					<input class="btn overlayCancelBtn" type="button" value="Cancel" onclick="modal.close();" /></div>
				</apex:form>
			</div>
		</div>

	</apex:outputpanel>
	</div>
	<!-- END NEW MEMBER OVERLAY -->
	
	<script>
		showAddMembersSection();
	</script>
	
</apex:page>