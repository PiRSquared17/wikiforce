<apex:page sidebar="false" tabStyle="Wiki__c" controller="WikiMembersRemoveController">
	<apex:stylesheet value="{!URLFOR($Resource.TeamsResources, 'inc/css/teamsMembersRemove.css')}" />
	<!-- Content  -->
	<div id="removeMemberOverlay" style="display: none;" class="overlayForm">
		<apex:outputPanel id="removeMemberContainer">
			<script>
				
				/**
				* Assign member id to hidden field idsToDelete
				* @param member id to remove from wiki. 
				*/
				function setHiddenMemberId(memberId){
					var elems  = $('overlayRemoveMember').getElementsByTagName('input');
					for(var i = 0; i< elems.length; i++){
						if(elems[i].type == 'hidden' && elems[i].id.split('idsToDelete').length > 1){
							elems[i].value = memberId;
						}
					}
				}
			
			</script>
	
			<!-- Overlay Title -->
			<div class="overlayTitleContent">
			<div class="overlayTitle">Confirmation</div>
			
				<div class="overlayCloseEvent">
						<a href="Javascript:;" onclick="modal.close();">
							<img src="{!URLFOR($Resource.TeamsResources, 'images/layout/genericClose.gif')}" alt="Close Window" title="Close Window" />
						</a> 
				</div>
			
			</div>
			<div class="overlayMainContent" id="overlayRemoveMember">
				<apex:form id="newMemberForm">
					<div class="overlayFormContent style="padding-bottom: 10px;">
						<apex:inputHidden id="idsToDelete" value="{!RemoveMemberIds}" />
						<apex:outputPanel rendered="{!NOT(error)}">
							<table style="width:95%;"> 
								<tr>
									<td ><span class="inputInfoDark">Are you sure you want to remove this member from {!wikiName}?</span></td>
								</tr>
								<tr>
									<td ><span class="inputInfo">Once a member is removed there is no way to undo this action.</span></td>
								</tr>			
							</table>
						</apex:outputPanel>
						
						<apex:outputPanel rendered="{!error}"> 
							<table style="width:95%;"> 
								<tr>
									<td ><span class="inputInfoDark">You could not remove {!delName} from {!wikiName} because is the last Wiki Adminstrator</span></td>
								</tr>			
							</table>
						</apex:outputPanel>						
					</div>
							
					<div class="overlaySeparateLine"></div>

					<!-- Save and Cancel Buttons -->			
					<div class="overlayFromButtons" align="center">
						
						<apex:outputPanel rendered="{!IF(error, false, true)}">
							<apex:commandButton style="background-color: #526921!important"
								styleclass="overlaySaveBtn allButtons actionButtons"
								action="{!massiveRemoveMember}" id="removeAction" 
								onclick="changeStatusButtonsRemoveOverlay(true); $('paginationOverlay').show();setHeight('memberListContainer', 'paginationOverlay');"  
								oncomplete="changeStatusButtonsRemoveOverlay(false);" 
								value="Continue"
								rerender="removeMemberStatus" />
							<input class="overlayCancelBtn allButtons cancelButtons" type="button" value="Cancel" onclick="modal.close();" />
							
						</apex:outputPanel> 
					
						<apex:outputPanel rendered="{!IF(error, true, false)}">
							<input class="overlayCancelBtn allButtons cancelButtons"
								type="button" value="Cancel" onclick="modal.close();" />
						</apex:outputPanel>
						
					</div>
				</apex:form>
			</div>
		</apex:outputpanel>
		
		<!-- Used to close overlay and rerender member list  -->
		<apex:outputPanel id="removeMemberStatus">
			<script>
				var removeStatus = '{!finish}';
				if( removeStatus == 'true' ){
					modal.close();
					reloadMemberList();
				}
				
				var errorStatus = '{!error}';
				//alert('{!error}');
				if( errorStatus == 'true' ){
					$('paginationOverlay').hide();
					document.getElementById('WikiCreateWiki:j_id417:j_id418:newMemberForm').innerHTML = '<span id="j_id455"><div class="overlayFormContent" style="padding-bottom: 10px;"><table style="width: 95%;"><tbody><tr><td><span class="inputInfoDark">You can not remove all admin members</span></td></tr></tbody></table></div> <div class="overlaySeparateLine"/> <div align="center" class="overlayFromButtons"><input type="button" class="allButtons cancelButtons" onclick="modal.close();" value="Cancel"/></div></span>';
       
				}
			</script>
		</apex:outputPanel>
	
	</div>

</apex:page>